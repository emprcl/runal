version: 2

project_name: runal

builds:
  - dir: cli
    goos:
      - linux
      - darwin
      - windows
    goarch:
      - amd64
      - arm64
      - "386"
      - arm
    goarm:
      - "7"
    ignore:
      - goos: windows
        goarch: arm64
      - goos: windows
        goarm: "7"
    ldflags:
      - -s -w -X main.version=v{{.Version}}
    mod_timestamp: "{{ .CommitTimestamp }}"

archives:
  - id: default
    name_template: >-
      {{ .ProjectName }}_
      {{- .Version }}_
      {{- title .Os }}_
      {{- if eq .Arch "amd64" }}x86_64
      {{- else if eq .Arch "386" }}i386
      {{- else }}{{ .Arch }}{{ end }}
    format_overrides:
      - goos: windows
        formats: zip
    files:
      - LICENSE
      - README.md

nfpms:
  - vendor: "emprcl"
    homepage: "https://empr.cl"
    maintainer: "Xavier Godart <xavier@empr.cl>"
    description: "A text-based creative coding environment for the terminal"
    file_name_template: "{{ .ConventionalFileName }}"
    license: MIT
    formats:
      - deb
      - rpm
      - archlinux
      - apk
    dependencies:
      - ffmpeg

# brews:
#   - name: runal
#     repository:
#       owner: emprcl
#       name: homebrew-tap
#     folder: Formula
#     homepage: https://github.com/emprcl/runal
#     description: "A cross-platform animation and graphics library for Go"
#     license: MIT
#     skip_upload: auto
#     install: |
#       bin.install "runal"
#     test: |
#       system "#{bin}/runal", "--version"

changelog:
  sort: asc
  use: github
  filters:
    exclude:
      - "^docs:"
      - "^test:"
      - "typo"
      - "merge conflict"
      - Merge pull request
      - Merge remote-tracking branch
      - Merge branch
  groups:
    - title: Features
      regexp: "^.*feat[(\\w)]*:+.*$"
      order: 0
    - title: Bug fixes
      regexp: "^.*fix[(\\w)]*:+.*$"
      order: 1
    - title: Others
      order: 999

# release:
#   github:
#     owner: emprcl
#     name: runal
#   draft: false
#   prerelease: auto
#   mode: replace
#   header: |
#     ## Release {{ .Tag }}

#     Welcome to this new release!

#   footer: |
#     ## Thanks

#     Thanks to all contributors who made this release possible!

#   name_template: "v{{ .Version }}"

checksum:
  name_template: "checksums.txt"

announce:
  skip: true
